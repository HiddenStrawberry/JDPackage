京东抽奖工具包 lotterypack.py
===========

这个文件是抽奖工具的主程序。包括了如下功能：
 
 1. 实现京东的定时抽奖功能，借助add_lottery函数您可以实现自定义抽奖组，多账号按指定间隔时间依次抽奖，还可以通过挂代理实现一抽一换IP，真正的100%安全。
 2. 借助get_iplist函数和filter_iplist函数您可以获得kuaidaili.com最新的免费代理IP，从而应用于定时抽奖功能。
 3. 借助read_lotteryfile函数可以读取Lotterycode代码字典文件，并输出完整的抽奖信息
 4. 借助testwater函数可以得到指定lotterycode的最近出水信息。
 
综上您可以看到，只要您学会使用本程序，便可以实现有关京东抽奖的几乎所有功能，故请**务必仔细**阅读该文档。
 

1.定时抽奖功能
--------

> 使用前需要预先加载两个文件，如下代码，分别是cookies文件和代理地址文件，cookies文件由cookies.py生成（用法见cookies.py的文档），代理文件为可选文件，如果您需要每抽一次更换一次IP，则您需要加载代理IP文件，可以使用get_iplist函数生成（使用方法见下文），生成的CSV可以直接加载到本程序中。

----------
加载方式：

    cookielist=loadCSVfile('cookies.csv') #加载Cookies文件
    proxylist=loadCSVfile('ip.csv') #加载代理地址文件

-------

> 用法为 add_lottery(userid组,抽奖代码,抽奖时间,两次抽奖间隔时间,cookielist,proxylist)

 - USERID：见cookies.py的文档中对于userid的说明
 - 抽奖代码：即为[jd-LotterySpi][3]工具爬取的lotterycode，形如4b6c385f-a626-48d2-8abe-f2ce2ebe5d5f
 - 抽奖时间：请注意时间格式务必为形如 2017-03-08 20:57:30 ，一旦当前时间到达（或超过）设定时间，抽奖即会立即开始
 - 两次抽奖间隔时间：本参数适用场景为：如同一个userid包括多个账号，即会每隔设定时间使用下一个账号进行抽取直到全部账号抽取完成
 - cookielist：固定参数，切勿更改
 - proxylist：可选参数，仅在有代理IP文件时使用本参数，如不使用代理IP请替换为proxylist=[]

----------
Example：

    add_lottery('1','4b6c385f-a626-48d2-8abe-f2ce2ebe5d5f','2017-03-08 20:57:30',5,cookielist,proxylist)

> 这段代码的含义是，在2017-03-08
> 20:57:30时使用userid为1的账号对抽奖代码为4b6c385f-a626-48d2-8abe-f2ce2ebe5d5f进行抽奖，每个账号间隔5秒进行抽取，每个账号换一个IP


----------

说明：
---

 - 您可以同时建立多个抽奖任务，每个add_lottery()视为新建一个线程，他们可以同时执行
 - 即便某个代理IP无效也没关系，程序会自动尝试替换下一个IP，请确保有效IP数量充足，一旦代理IP用尽，程序会自动停止！
 - 抽奖结果会保存到f.txt中


----------

2.获取免费代理IP功能
------------


    get_iplist('ip.csv',3,'inha') #参数为（文件名，页数，代理类别）；代理类别包含4种(inha:国内高匿,intr:国内普通,outha:国外高匿,outtr:国外普通）
这个函数用来获取kuaidaili.com的最新代理IP列表。

out：

    Page 1
    171.38.181.79 8123 HTTP 广西壮族自治区钦州市  联通 1秒 2017-03-05 22:38:39
    117.175.183.10 4860 HTTP 中国 四川省 成都市 移动 1秒 2017-03-05 21:38:49
    118.181.162.31 8998 HTTP 中国 甘肃省 兰州市 电信 1秒 2017-03-05 20:38:45
    117.175.183.10 8000 HTTP 中国 四川省 成都市 移动 3秒 2017-03-05 19:38:48
    36.47.196.145 8998 HTTP 中国 陕西省 西安市 电信 1.0秒 2017-03-05 18:38:34
    117.90.5.10 9000 HTTP 中国 江苏省 镇江市 电信 2秒 2017-03-05 17:38:47
    117.90.1.34 9000 HTTP 中国 江苏省 镇江市 电信 2秒 2017-03-05 16:38:44
    117.90.6.134 9000 HTTP 中国 江苏省 镇江市 电信 1秒 2017-03-05 15:38:42
    125.123.76.134 8998 HTTP 中国 浙江省 嘉兴市 电信 2秒 2017-03-05 14:38:46
    125.67.75.53 9000 HTTP 中国 四川省 遂宁市 电信 3秒 2017-03-05 13:38:37
    115.28.169.160 8118 HTTP 中国 山东省 青岛市 阿里云 3秒 2017-03-05 12:38:34
    117.90.1.35 9000 HTTP 中国 江苏省 镇江市 电信 0.9秒 2017-03-05 11:38:40
    111.72.126.161 808 HTTP 中国 江西省 吉安市 电信 秒 2017-03-05 10:38:36
    121.232.148.94 9000 HTTP 中国 江苏省 镇江市 电信 2秒 2017-03-05 09:38:42
    ……
  


----------


  

    filter_iplist('ip.csv', 'new.csv', 2)  # 过滤出有效IP并存储为new.csv 参数为（文件名，过滤后的文件名，超时判定秒数）
    
这个函数用来过滤出有效的代理IP并存成一个新文件new.csv。


----------
在定时抽奖功能的应用：

    get_iplist('ip.csv', 3, 'inha')  
    filter_iplist('ip.csv', 'new.csv', 2)
    cookielist = loadCSVfile('cookies.csv')  # 加载Cookies文件
    proxylist = loadCSVfile('new.csv')  # 加载代理地址文件
    add_lottery('1', '4b6c385f-a626-48d2-8abe-f2ce2ebe5d5f', '2017-03-08 20:57:30', 5, cookielist, proxylist)  
    add_lottery('2', '4b6c385f-a626-48d2-8abe-f2ce2ebe5d5f', '2017-03-08 20:57:30', 5, cookielist, proxylist) 

如此，即新建了两个完整的，使用了代理IP的抽奖进程。


----------


3.读取lotterycode代码字典
-------------------
Example:

    read_dict('code.txt') #输出抽奖代码具体内容
Out:

    ……
    title: 京东【柔光双摄 照亮不凡】活动为您推荐当下最流行的品牌vivo Xplay6 vivox9  手机 vivo手机  vivox7 vivox7plus 1212,欢迎参加京东【柔光双摄 照亮不凡】" 
    Pricetype: 1
    code: e332a393-4842-4fe9-829d-1660939deb9d
    URL: http://sale.jd.com/act/vgwkogoy2nbppq.html
    Prize: [ X9手机 ]   [ 50元优惠券 ]   [ 小V蓝牙音箱 ]   [ 20元优惠券 ]   [ 爱奇艺视频月卡 ]   
    Time: 2017-03-02 17:53:00 - 2017-03-14 17:53:00
    PrizeDesc:
    [ 恭喜获得vivo X9手机一部，请在3月13日10点前联系vivo京东官方旗舰店在线客服确认中奖信息并提供收货地址，逾期未提供视为主动放弃奖品！ ]
    [ 恭喜获得50元vivo优惠券，系统自动发放，请在“我的京东-优惠券”查看，使用期限2月6日-2月18日 ]
    [ 恭喜获得小V蓝牙音箱一个，请在3月13日10点前联系vivo京东官方旗舰店在线客服确认中奖信息并提供收货地址，逾期未提供视为主动放弃奖品！ ]
    [ 恭喜获得20元vivo优惠券，系统自动发放，请在“我的京东-优惠券”查看，使用期限使用期限3月6日-2月18日 ]
    [ 恭喜获得爱奇艺视频月卡激活码，请在3月13日10点前联系vivo京东官方旗舰店在线客服领取爱奇艺视频月卡激活码，逾期未提供视为主动放弃奖品！ ]
    ……


----------


4.测水工具
-------------------
----------
Example:

    testwater('d2d7f4a5-adb7-41c5-96ce-ba923ea88eba') #输出某代码最近的出奖时间
Out:
   

        2017-03-05 11:19:00 迪丽热巴签名照
        2017-03-04 11:34:30 迪丽热巴签名照
        2017-03-02 11:18:40 迪丽热巴签名照
        2017-03-02 10:57:31 100元面膜礼包
        2017-03-02 10:19:06 迪丽热巴签名照
        2017-03-01 10:19:39 迪丽热巴签名照

有任何问题欢迎添加QQ交流群：108934299
========================

 
   
   
